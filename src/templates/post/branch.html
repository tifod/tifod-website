{% set children = post['children'] %}

<div class="post-siblings">
    {# nav bar #}
    {% if children|length > 1 or children[0]['remakes'] %}
        <div class="prev"><i class="fa fa-chevron-left fa-2x"></i></div>
        <div class="next"><i class="fa fa-chevron-right fa-2x"></i></div>
        <div class="post-siblings-nav">
            <form>
                {% for t_child in children %}
                    <div class="group-post-link">
                        <label class="link" data-target="{{ t_child['id'] }}">
                            <input type="radio" class="link-radio-button" id="{{ t_child['id'] }}-radio-button" name="radio-{{ post['id'] }}" {% if loop.first and (not t_child['remakes'] or t_child['remakes'][0]['has_pin'] == '0') %}checked{% endif %} />
                            <div class="link-btn"></div>
                            {% set loopfirstparent = loop.first %}
                        </label>
                        {% if t_child['remakes'] %}
                            {% for t_remake in t_child['remakes'] %}
                                <label class="link" data-target="{{ t_remake['id'] }}">
                                    <input type="radio" class="link-radio-button" id="{{ t_remake['id'] }}-radio-button" name="radio-{{ post['id'] }}" {% if loopfirstparent and t_remake['has_pin'] == '1' %}checked{% endif %}/>
                                    <div class="link-btn link-btn-remake"></div>
                                </label>
                            {% endfor %}
                        {% endif %}
                    </div>
                {% endfor %}
            </form>
        </div>
    {% endif %}
    
    {# posts #}
    <div class="posts{% if children|length > 1 or children[0]['remakes'] %} many-posts{% endif %}">
    {% for child in children %}
        {% set lastChild = children[children|length - 1] %}        
        <div>
            <div class="post{% if loop.first %} active-post{% endif %}" id="{{ child['id'] }}" data-path="{{ child['path'] }}">
        
                {# content #}
                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/public/img/post/{{ child['content'] }}">
                
                {# post infos #}
                {% include "/post/post-infos.html" with {'post':child} %}
            </div>
        </div>
        {# remakes #}
        {% if child['remakes'] %}
            {% for remake in child['remakes'] %}
                <div>
                    <div class="post post-remake" id="{{ remake['id'] }}" data-parentid="{{ child['id'] }}" data-path="{{ remake['path'] }}">
                        {# content #}
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/public/img/post/{{ remake['content'] }}">
                        
                        {# post infos #}
                        {% include "/post/post-infos.html" with {'post':remake} %}
                    </div>
                </div>
            {% endfor %}
        {% endif %}
    {% endfor %}
    </div>
</div>

{# post children #}
{% for child in children%}
    {% if child['children'] %}
        <div class="post-level{% if loop.first %} active-level{% endif %}" id="{{ child['id'] }}-children">
                {% include "post/branch.html" with {'post': child} %}
        </div>
    {% endif %}
{% endfor %}